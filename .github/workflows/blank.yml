name: Rancher Fix 502 - Ultra Light
on: [workflow_dispatch]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Recupere uniquement les manquants
        run: |
          # 1. Les images absentes de ton crictl
          docker pull rancher/kubectl:v1.29.2
          docker pull rancher/rancher-agent:v2.10.2
          
          # 2. Sauvegarde (On ne prend QUE celles-l√†)
          docker save \
            rancher/kubectl:v1.29.2 \
            rancher/rancher-agent:v2.10.2 \
            -o rancher-missing-images.tar
          
          gzip rancher-missing-images.tar

      - name: Export Artifact
        uses: actions/upload-artifact@v4
        with:
          name: rancher-light-fix
          path: rancher-missing-images.tar.gz
